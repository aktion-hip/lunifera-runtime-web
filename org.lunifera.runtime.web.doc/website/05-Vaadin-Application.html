<br style="clear:both;height:1em;">
	<div id="leftcol">
		<div class="nav-logo">
			<a href="index.php"><img src="logo.png" style="margin-left:10px; width:155px"/></a>
		</div>
		<ul id="leftnav">
		<li class="separator"><div class="separator">
		<img src="triangle.gif" style="height:12px; margin-right: 2px; "  /><img src="triangle-90.gif" style="display:none; margin-right: 2px" height="12px" />
		<a href="01-Introduction.php">Overview</a></div>
		<ul style="display: none;" id="subToc_01-Introduction.html">
		<li id="01-Introduction.html#_Content.html" ><a href="01-Introduction.php#_Content.php" >Content</a></li>
		</ul>
		</li>
		<li class="separator"><div class="separator">
		<img src="triangle.gif" style="height:12px; margin-right: 2px; "  /><img src="triangle-90.gif" style="display:none; margin-right: 2px" height="12px" />
		<a href="03-Jetty-Service.php">IJetty-Service</a></div>
		<ul style="display: none;" id="subToc_03-Jetty-Service.html">
		<li id="03-Jetty-Service.html#_Overview.html" ><a href="03-Jetty-Service.php#_Overview.php" >Overview</a></li>
		<li id="03-Jetty-Service.html#_Properties.html" ><a href="03-Jetty-Service.php#_Properties.php" >Properties</a></li>
		<li id="03-Jetty-Service.html#_CodeSamples.html" ><a href="03-Jetty-Service.php#_CodeSamples.php" >Code sampels</a></li>
		<li id="03-Jetty-Service.html#_consoleCommands.html" ><a href="03-Jetty-Service.php#_consoleCommands.php" >Console commands</a></li>
		<li id="03-Jetty-Service.html#_Query.html" ><a href="03-Jetty-Service.php#_Query.php" >Query jetty services</a></li>
		<li id="03-Jetty-Service.html#_startStop.html" ><a href="03-Jetty-Service.php#_startStop.php" >Start and stop jetty services</a></li>
		</ul>
		</li>
		<li class="separator"><div class="separator">
		<img src="triangle.gif" style="height:12px; margin-right: 2px; "  /><img src="triangle-90.gif" style="display:none; margin-right: 2px" height="12px" />
		<a href="04-Http-Application.php">Http Application</a></div>
		<ul style="display: none;" id="subToc_04-Http-Application.html">
		<li id="04-Http-Application.html#_Overview.html" ><a href="04-Http-Application.php#_Overview.php" >Overview</a></li>
		<li id="04-Http-Application.html#_Properties.html" ><a href="04-Http-Application.php#_Properties.php" >Properties</a></li>
		<li id="04-Http-Application.html#_ServletContext.html" ><a href="04-Http-Application.php#_ServletContext.php" >ServletContext</a></li>
		<li id="04-Http-Application.html#_HttpService.html" ><a href="04-Http-Application.php#_HttpService.php" >HttpService</a></li>
		<li id="04-Http-Application.html#_CodeSamples.html" ><a href="04-Http-Application.php#_CodeSamples.php" >Code sampels</a></li>
		<li id="04-Http-Application.html#_consoleCommands.html" ><a href="04-Http-Application.php#_consoleCommands.php" >Console commands</a></li>
		<li id="04-Http-Application.html#_QueryHttp.html" ><a href="04-Http-Application.php#_QueryHttp.php" >Query Http-applications</a></li>
		<li id="04-Http-Application.html#_QueryHandlerProvider.html" ><a href="04-Http-Application.php#_QueryHandlerProvider.php" >Query Handler-Provider</a></li>
		<li id="04-Http-Application.html#_QueryHttpServices.html" ><a href="04-Http-Application.php#_QueryHttpServices.php" >Query HttpServices</a></li>
		</ul>
		</li>
		<li class="separator"><div class="separator">
		<img src="triangle.gif" style="height:12px; margin-right: 2px; "  /><img src="triangle-90.gif" style="display:none; margin-right: 2px" height="12px" />
		<a href="05-Vaadin-Application.php">Vaadin Application</a></div>
		<ul style="display: none;" id="subToc_05-Vaadin-Application.html">
		<li id="05-Vaadin-Application.html#_Overview.html" ><a href="05-Vaadin-Application.php#_Overview.php" >Overview</a></li>
		<li id="05-Vaadin-Application.html#_Properties.html" ><a href="05-Vaadin-Application.php#_Properties.php" >Properties</a></li>
		<li id="05-Vaadin-Application.html#_CodeSamples.html" ><a href="05-Vaadin-Application.php#_CodeSamples.php" >Code sampels</a></li>
		<li id="05-Vaadin-Application.html#_consoleCommands.html" ><a href="05-Vaadin-Application.php#_consoleCommands.php" >Console commands</a></li>
		<li id="05-Vaadin-Application.html#_QueryHttp.html" ><a href="05-Vaadin-Application.php#_QueryHttp.php" >Query Vaadin-Applications</a></li>
		<li id="05-Vaadin-Application.html#_IVaadinApplication.html" ><a href="05-Vaadin-Application.php#_IVaadinApplication.php" >Vaadin-Appplication-service</a></li>
		</ul>
		</li>
		</ul>
	</div>
	<div id="midcolumn">
		<a name="VaadinApplication" ></a>
		<h1>Vaadin Application</h1>
				<div class="toc">
				  <ul>
				    <li><a href="05-Vaadin-Application.php#_Overview.php" >Overview</a></li>
				    <li><a href="05-Vaadin-Application.php#_Properties.php" >Properties</a></li>
				    <li><a href="05-Vaadin-Application.php#_CodeSamples.php" >Code sampels</a></li>
				    <li><a href="05-Vaadin-Application.php#_consoleCommands.php" >Console commands</a></li>
				    <li><a href="05-Vaadin-Application.php#_QueryHttp.php" >Query Vaadin-Applications</a></li>
				    <li><a href="05-Vaadin-Application.php#_IVaadinApplication.php" >Vaadin-Appplication-service</a></li>
				  </ul>
				</div>
				
		<p>
		The bundle <span class="inlinecode">org.lunifera.runtime.web.vaadin.osgi</span> was introduced to integrate vaadin into
		OSGi environments properly. It only support vaadin 7 and can not be used for vaadin 6.
		</p>
		<p>
		The implementation tries to minimize the required client code to startup a vaadin application. To run
		a vaadin application one OSGi-ComponentFactory definition is required.
		It has to provide instances of <abbr title="org.lunifera.runtime.web.vaadin.osgi.common.OSGiUI" >OSGiUI</abbr> that are the root UI-instances for
		each browser tab. And it has to address the target Vaadin-Application-Instance the UI-definition belongs
		to.
		</p>
		<p>
		A standalone example can be found in the bundle <span class="inlinecode">org.lunifera.examples.runtime.web.vaadin.standalone</span>.
		</p>
		<a name="_Overview" ></a>
		<span style="float:left; border-top: 1px dotted #d4d4dd; margin-left: 0; margin-top: 5px;
			padding: 5px 0;
			padding-top: 5px;"></span><a style="float: right" href="#">Top</a>
			<br style="clear:both"></br>
			<h1>Overview</h1>
			<div class="toc">
			  <ul>
			    <li><a href="05-Vaadin-Application.php#_Overview_4.php" >Intro example</a></li>
			  </ul>
			</div>
			<p>
			<div class="image" >
			<a class="gallery" rel="prettyPhoto[all]" title="Image 1: Overview" href="images/VaadinApplication.png">
				<img src="images/VaadinApplication.png" 
					class="img-small" 
				/>
			</a>
			<div class="caption">
				Image 1: Overview
			</div>
			</div>
			</p>
			<p>
			To ensure a maximum of flexibility the <abbr title="org.lunifera.runtime.web.vaadin.osgi.common.IVaadinApplication" >IVaadinApplication</abbr> is implemented using <a href="http://wiki.osgi.org/wiki/Configuration_Admin" >OSGi-CM</a>.
			Configurations can be created by the <abbr title="org.osgi.service.cm.ConfigurationAdmin" >ConfigurationAdmin</abbr>
			passing a service factory PID (persistence id) and properties. 
			</p>
			<p>
			The configuration admin...
			  <ol>
			  <li>stores/updates the config in the persistence store</li>
			  <li>forwards the config to the <abbr title="org.osgi.service.cm.ManagedServiceFactory" >ManagedServiceFactory</abbr>
			  		named <abbr title="org.lunifera.runtime.web.vaadin.osgi.webapp.VaadinApplicationFactory" >VaadinApplicationFactory</abbr></li>
			  <li>the <abbr title="org.lunifera.runtime.web.vaadin.osgi.webapp.VaadinApplicationFactory" >VaadinApplicationFactory</abbr>... 
			  		<ul>
			    <li>... creates a new instance of IVaadinApplication if no service is available for the given PID (not factory PID!).
			    		Each IVaadinApplication accesses a <a href="04-Http-Application.php#_HttpService.php" title="Go to &quot;HttpService&quot;">HttpService</a> and registers its servlets,
			    		filters and resources on it.</li>
			    <li>... stops the IVaadinApplication instance, updates its values and starts it again, if a service is available for the
			    			PID. (The servlet context will also become removed from the jetty server)</li>
			    <li>... stops the IVaadinApplication and deletes the config if delete was called on the config.</li>
			  </ul>
			  
			  </li>
			</ol>
			</p>
			<a name="_Overview_4" ></a>
			<h2>Intro example</h2>
			<p>
			The following code will create a new Vaadin-Application which uses the HttpService provided by the name
			&quot;Http1&quot; to register its servlets, filters and resources.
			</p>
			<p>
			The URI to access the Vaadin-Application is built by the
			  <ol>
			  <li>Jetty-Server-Instance the Http-Application is deployed at</li>
			  <li>The context patch of the HttpService that was provided by the Http-Application</li>
			  <li>The uiAlias specified for the Vaadin-Application</li>
			</ol>
			 
			  
			See example picture above and lets assume that Http1 is deployed at a JettyServer on port 8089. Then
			the URI to access the vaadin UI would be <span class="inlinecode">http:<span class="comment">//localhost:8089/demo/carstore/main</span></span>.
			</p>
			<p>
			<div class="literallayout">
				<div class="incode">
					<p class="code">
						<span class="comment">//&nbsp;Create&nbsp;new&nbsp;servletContext<br/>
						</span><span class="comment">//<br/>
						</span><br/>
						<span class="comment">//&nbsp;create&nbsp;properties&nbsp;and&nbsp;add&nbsp;values&nbsp;to&nbsp;it<br/>
						</span>Dictionary&lt;String,&nbsp;Object&gt;&nbsp;props&nbsp;=&nbsp;<span class="keyword">new</span>&nbsp;Hashtable&lt;String,&nbsp;Object&gt;();<br/>
						props.put(VaadinConstants.APPLICATION_NAME,&nbsp;<span class="string">"Carstore-Web"</span>);<br/>
						props.put(VaadinConstants.UI_ALIAS,&nbsp;<span class="string">"main"</span>);<br/>
						props.put(VaadinConstants.WIDGETSET,&nbsp;<span class="string">"org.lunifera.examples.runtime.web.vaadin.standalone.widgetset.Widgetset"</span>);<br/>
						props.put(VaadinConstants.HTTP_APPLICATION_NAME,&nbsp;<span class="string">"Http1"</span>);<br/>
						<br/>
						<span class="comment">//&nbsp;create&nbsp;new&nbsp;config&nbsp;by&nbsp;config&nbsp;admin<br/>
						</span><span class="comment">//&nbsp;using&nbsp;the&nbsp;Factory-PID<br/>
						</span>Configuration&nbsp;config&nbsp;=&nbsp;admin.createFactoryConfiguration(<br/>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VaadinConstants.OSGI__FACTORY_PID,&nbsp;null);<br/>
						<br/>
						<span class="comment">//&nbsp;create&nbsp;the&nbsp;configuration&nbsp;<br/>
						</span><span class="comment">//&nbsp;and&nbsp;forward&nbsp;to&nbsp;the&nbsp;VaadinApplicationFactory<br/>
						</span>config.update(props);
					</p>
				</div>
			</div>
			</p>
		<a name="_Properties" ></a>
		<span style="float:left; border-top: 1px dotted #d4d4dd; margin-left: 0; margin-top: 5px;
			padding: 5px 0;
			padding-top: 5px;"></span><a style="float: right" href="#">Top</a>
			<br style="clear:both"></br>
			<h1>Properties</h1>
			<p>
			All properties that can be used are contained in <abbr title="org.lunifera.runtime.web.vaadin.osgi.common.VaadinConstants" >VaadinConstants</abbr>
			and the value type is String.
			</p>
			<p>
			<table>
			  <tr>
			    <td>ID</td>
			    <td>Name</td>
			    <td>Description</td>
			    <td>Default</td>
			    <td>Filterable</td>
			  </tr>
			  <tr>
			    <td><span class="inlinecode">lunifera.vaadin.application.factory</span></td>
			    <td>Factory PID</td>
			    <td>Create a new config using the config admin</td>
			    <td></td>
			    <td>true</td>
			  </tr>
			  <tr>
			    <td><span class="inlinecode">lunifera.web.vaadin.id</span></td>
			    <td>Vaadin-Application Id</td>
			    <td>The unique application id</td>
			    <td></td>
			    <td>true</td>
			  </tr>
			  <tr>
			    <td><span class="inlinecode">lunifera.web.vaadin.name</span></td>
			    <td>Vaadin-Application Name</td>
			    <td>The name of the application</td>
			    <td>vaadindefault</td>
			    <td>true</td>
			  </tr>
			  <tr>
			    <td><span class="inlinecode">lunifera.web.vaadin.uialias</span></td>
			    <td>UI alias</td>
			    <td>The alias to access the main UI</td>
			    <td>lunifera</td>
			    <td>true</td>
			  </tr>
			  <tr>
			    <td><span class="inlinecode">lunifera.web.vaadin.widgetset</span></td>
			    <td>Widgetset Name</td>
			    <td>The name of the widgetset that should
			    be used</td>
			    <td></td>
			    <td>true</td>
			  </tr>
			  <tr>
			    <td><span class="inlinecode">lunifera.http.name</span></td>
			    <td>Http-Application name</td>
			    <td>The name of the Http-Application. The HttpService
			    will be filtered by that name</td>
			    <td></td>
			    <td>true</td>
			  </tr>
			</table>
			</p>
		<a name="_CodeSamples" ></a>
		<span style="float:left; border-top: 1px dotted #d4d4dd; margin-left: 0; margin-top: 5px;
			padding: 5px 0;
			padding-top: 5px;"></span><a style="float: right" href="#">Top</a>
			<br style="clear:both"></br>
			<h1>Code sampels</h1>
			<div class="toc">
			  <ul>
			    <li><a href="05-Vaadin-Application.php#_CodeSamples_1.php" >HttpService selection</a></li>
			    <li><a href="05-Vaadin-Application.php#_CodeSamples_2.php" >Create new Vaadin-Application-Instance</a></li>
			    <li><a href="05-Vaadin-Application.php#_CodeSamples_3.php" >Update existing Vaadin-Application-Instance</a></li>
			    <li><a href="05-Vaadin-Application.php#_CodeSamples_4.php" >Delete existing Vaadin-Application-Instance</a></li>
			  </ul>
			</div>
			<a name="_CodeSamples_1" ></a>
			<h2>HttpService selection</h2>
			<p>
			The vaadin application will internal use an ExtendedHttpService to register the servlets, filter and resources.
			To find the assigned HttpService, the property VaadinConstants.HTTP_APPLICATION_NAME is used by the vaadin application to select the assgined HttpService.
			</p>
			<p>
			<div class="literallayout">
				<div class="incode">
					<p class="code">
						<span class="comment">//&nbsp;Find&nbsp;proper&nbsp;http&nbsp;service<br/>
						</span><span class="comment">//<br/>
						</span>Collection&lt;ServiceReference&lt;ExtendedHttpService&gt;&gt;&nbsp;references&nbsp;=&nbsp;bundleContext<br/>
						&nbsp;&nbsp;&nbsp;&nbsp;.getServiceReferences(ExtendedHttpService.<span class="keyword">class</span>,&nbsp;<span class="string">"(&amp;(objectClass=org.eclipse.equinox.http.servlet.ExtendedHttpService)(lunifera.http.name=Http1))"</span>);<br/>
						....
					</p>
				</div>
			</div>
			</p>
			<a name="_CodeSamples_2" ></a>
			<h2>Create new Vaadin-Application-Instance</h2>
			<p>
			Creating a new vaadin application instance is very simple. You just have to create a new config by the configAdmin
			and the factory PID. On calling update with the properties the VaadinApplicationFactory will create a new instance
			of vaadin application. 
			</p>
			<p>
			<div class="literallayout">
				<div class="incode">
					<p class="code">
						<span class="comment">//&nbsp;Create&nbsp;new&nbsp;servletContext<br/>
						</span><span class="comment">//<br/>
						</span><br/>
						<span class="comment">//&nbsp;create&nbsp;properties&nbsp;and&nbsp;add&nbsp;values&nbsp;to&nbsp;it<br/>
						</span>Dictionary&lt;String,&nbsp;Object&gt;&nbsp;props&nbsp;=&nbsp;<span class="keyword">new</span>&nbsp;Hashtable&lt;String,&nbsp;Object&gt;();<br/>
						props.put(VaadinConstants.APPLICATION_NAME,&nbsp;<span class="string">"Carstore-Web"</span>);<br/>
						props.put(VaadinConstants.UI_ALIAS,&nbsp;<span class="string">"main"</span>);<br/>
						props.put(VaadinConstants.WIDGETSET,&nbsp;<span class="string">"org.lunifera.examples.runtime.web.vaadin.standalone.widgetset.Widgetset"</span>);<br/>
						props.put(VaadinConstants.HTTP_APPLICATION_NAME,&nbsp;<span class="string">"Http1"</span>);<br/>
						<br/>
						<span class="comment">//&nbsp;create&nbsp;new&nbsp;config&nbsp;by&nbsp;config&nbsp;admin<br/>
						</span><span class="comment">//&nbsp;using&nbsp;the&nbsp;Factory-PID<br/>
						</span>Configuration&nbsp;config&nbsp;=&nbsp;admin.createFactoryConfiguration(<br/>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VaadinConstants.OSGI__FACTORY_PID,&nbsp;null);<br/>
						<br/>
						<span class="comment">//&nbsp;create&nbsp;the&nbsp;configuration&nbsp;<br/>
						</span><span class="comment">//&nbsp;and&nbsp;forward&nbsp;to&nbsp;the&nbsp;VaadinApplicationFactory<br/>
						</span>config.update(props);
					</p>
				</div>
			</div>
			</p>
			<a name="_CodeSamples_3" ></a>
			<h2>Update existing Vaadin-Application-Instance</h2>
			<p>
			To update an existing vaadin application instance, you have to know its PID. Not the &quot;factory PID&quot; but the
			unique PID of the http application instance. How to access the PID of a Vaadin-Application-Instance will be described
			later.
			</p>
			<p>
			Following code will force the vaadin application to use HttpService with name Http2.
			</p>
			<p>
			<div class="literallayout">
				<div class="incode">
					<p class="code">
						<span class="comment">//&nbsp;update&nbsp;existing&nbsp;configuration<br/>
						</span><span class="comment">//<br/>
						</span><br/>
						<span class="comment">//&nbsp;access&nbsp;the&nbsp;pid&nbsp;for&nbsp;vaadin&nbsp;application&nbsp;1&nbsp;from&nbsp;example&nbsp;above<br/>
						</span>String&nbsp;pid&nbsp;=&nbsp;getPIDForVaadinApplication(<span class="string">"Carstore-Web"</span>);<br/>
						<br/>
						<span class="comment">//&nbsp;get&nbsp;the&nbsp;config<br/>
						</span>Configuration&nbsp;config&nbsp;=&nbsp;admin.getConfiguration(pid);<br/>
						<br/>
						<span class="comment">//&nbsp;update&nbsp;the&nbsp;config&nbsp;with&nbsp;new&nbsp;properties<br/>
						</span>Dictionary&lt;String,&nbsp;Object&gt;&nbsp;props&nbsp;=&nbsp;<span class="keyword">new</span>&nbsp;Hashtable&lt;String,&nbsp;Object&gt;();<br/>
						props.put(VaadinConstants.HTTP_APPLICATION_NAME,&nbsp;<span class="string">"Http2"</span>);<br/>
						<br/>
						config.update(props);
					</p>
				</div>
			</div>
			</p>
			<p>
			What happens:
			<ol>
			  <li>Vaadin application with name &quot;Carstore-Web&quot; was stopped</li>
			  <li>Vaadin-Application unregistered servlets,... from HttpService with name Http1</li>
			  <li><span class="inlinecode">lunifera.http.name</span>-property was set to &quot;Http2&quot;</li>
			  <li>Vaadin application was started again</li>
			  <li>Vaadin-Application accesses HttpService with name Http2</li>
			  <li>Vaadin-Application registers servlets,... at new HttpService</li>
			</ol>
			</p>
			<a name="_CodeSamples_4" ></a>
			<h2>Delete existing Vaadin-Application-Instance</h2>
			<p>
			To delete an existing vaadin application instance, you have to know its PID. Not the &quot;factory PID&quot; but the
			unique PID of the vaadin application instance. How to access the PID of a Vaadin-Application-Instance will be described
			later.
			</p>
			<p>
			The following code will delete the vaadin application from example above.
			</p>
			<p>
			<div class="literallayout">
				<div class="incode">
					<p class="code">
						<span class="comment">//&nbsp;delete&nbsp;existing&nbsp;configuration<br/>
						</span><span class="comment">//<br/>
						</span><br/>
						<span class="comment">//&nbsp;access&nbsp;the&nbsp;pid&nbsp;for&nbsp;vaadin&nbsp;application<br/>
						</span>String&nbsp;pid&nbsp;=&nbsp;getPIDForVaadinApplication(<span class="string">"Carstore-Web"</span>);<br/>
						<br/>
						<span class="comment">//&nbsp;get&nbsp;the&nbsp;config<br/>
						</span>Configuration&nbsp;config&nbsp;=&nbsp;admin.getConfiguration(pid);<br/>
						<span class="comment">//&nbsp;delete&nbsp;it<br/>
						</span>config.delete();
					</p>
				</div>
			</div>
			</p>
			<p>
			What happens:
			<ol>
			  <li>Vaadin application with name &quot;Carstore-Web&quot; was stopped</li>
			  <li>Vaadin-Application unregistered all servlets,...</li>
			</ol>
			</p>
		<a name="_consoleCommands" ></a>
		<span style="float:left; border-top: 1px dotted #d4d4dd; margin-left: 0; margin-top: 5px;
			padding: 5px 0;
			padding-top: 5px;"></span><a style="float: right" href="#">Top</a>
			<br style="clear:both"></br>
			<h1>Console commands</h1>
			<p>
			The vaadin application feature provides OSGi console commands:
			</p>
			<p>
			<div class="literallayout">
				<div class="incode">
					<p class="code">
						osgi&gt;lvaadin<br/>
						----&nbsp;Lunifera&nbsp;vaadin&nbsp;application&nbsp;commands&nbsp;----<br/>
						&nbsp;&nbsp;&nbsp;lvaadin&nbsp;&lt;cmd&gt;&nbsp;[args]<br/>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;start|stop&gt;&nbsp;[application&nbsp;id]&nbsp;-&nbsp;Starts&nbsp;or&nbsp;stops&nbsp;the&nbsp;vaadin&nbsp;application&nbsp;with&nbsp;the&nbsp;given&nbsp;id<br/>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ls&gt;&nbsp;&nbsp;-&nbsp;Lists&nbsp;all&nbsp;registered&nbsp;vaadin&nbsp;applications<br/>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;properties&gt;&nbsp;&nbsp;-&nbsp;Lists&nbsp;all&nbsp;available&nbsp;service&nbsp;properties
					</p>
				</div>
			</div>
			</p>
			<p>
			For instance <span class="inlinecode">ljetty&nbsp;ls</span> list all active http applications.
			<div class="literallayout">
				<div class="incode">
					<p class="code">
						osgi&gt;lvaadin&nbsp;ls<br/>
						&nbsp;&nbsp;&nbsp;&nbsp;----&nbsp;Available&nbsp;vaadin&nbsp;application&nbsp;instances&nbsp;----<br/>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id:&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name:&nbsp;ECViewApplication&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vaadin&nbsp;application:&nbsp;ECViewApplication&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ui&nbsp;alias:&nbsp;demo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;widgetset:&nbsp;org.lunifera.examples.runtime.web.ecp.uimodel.presentation.vaadin.widgetset.Widgetset
					</p>
				</div>
			</div>
			</p>
		<a name="_QueryHttp" ></a>
		<span style="float:left; border-top: 1px dotted #d4d4dd; margin-left: 0; margin-top: 5px;
			padding: 5px 0;
			padding-top: 5px;"></span><a style="float: right" href="#">Top</a>
			<br style="clear:both"></br>
			<h1>Query Vaadin-Applications</h1>
			<div class="toc">
			  <ul>
			    <li><a href="05-Vaadin-Application.php#_QueryHttp_3.php" >Find pid by name</a></li>
			    <li><a href="05-Vaadin-Application.php#_QueryHttp_4.php" >Find pid by Widgetset</a></li>
			  </ul>
			</div>
			<p>
			This sections demonstrates how vaadin applications can be filtered. Therefore OSGi service filters are used.
			Section <a href="05-Vaadin-Application.php#_Properties.php" title="Go to &quot;Properties&quot;">Properties</a> shows all properties that can be used to query a http application.
			</p>
			<p>
			That are
			<ul>
			  <li><span class="inlinecode">lunifera.vaadin.application.factory</span></li>
			  <li><span class="inlinecode">lunifera.web.vaadin.id</span></li>
			  <li><span class="inlinecode">lunifera.web.vaadin.name</span></li>
			  <li><span class="inlinecode">lunifera.web.vaadin.uialias</span></li>
			  <li><span class="inlinecode">lunifera.web.vaadin.widgetset</span></li>
			  <li><span class="inlinecode">lunifera.http.name</span></li>
			</ul>
			</p>
			<a name="_QueryHttp_3" ></a>
			<h2>Find pid by name</h2>
			<p>
			<div class="literallayout">
				<div class="incode">
					<p class="code">
						<span class="comment">//&nbsp;find&nbsp;service&nbsp;reference<br/>
						</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Collection&lt;ServiceReference&lt;IVaadinApplication&gt;&gt;&nbsp;references&nbsp;=&nbsp;bundleContext<br/>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.getServiceReferences(IVaadinApplication.<span class="keyword">class</span>,&nbsp;<span class="string">"(lunifera.web.vaadin.name=Carstore-Web)"</span>);<br/>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(references.iterator().hasNext())&nbsp;{<br/>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServiceReference&lt;IVaadinApplication&gt;&nbsp;reference&nbsp;=&nbsp;references.iterator().next();<br/>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;access&nbsp;PID&nbsp;by&nbsp;properties<br/>
						</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;pid&nbsp;=&nbsp;(String)&nbsp;reference.getProperty(org.osgi.framework.Constants.SERVICE_PID);<br/>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
					</p>
				</div>
			</div>
			</p>
			<a name="_QueryHttp_4" ></a>
			<h2>Find pid by Widgetset</h2>
			<p>
			<div class="literallayout">
				<div class="incode">
					<p class="code">
						<span class="comment">//&nbsp;find&nbsp;service&nbsp;reference<br/>
						</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Collection&lt;ServiceReference&lt;IVaadinApplication&gt;&gt;&nbsp;references&nbsp;=&nbsp;bundleContext<br/>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.getServiceReferences(IVaadinApplication.<span class="keyword">class</span>,&nbsp;<span class="string">"(lunifera.web.vaadin.widgetset=org.lunifera.examples.runtime.web.vaadin.standalone.widgetset.Widgetset)"</span>);<br/>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;(references.iterator().hasNext())&nbsp;{<br/>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServiceReference&lt;IVaadinApplication&gt;&nbsp;reference&nbsp;=&nbsp;references.iterator().next();<br/>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;access&nbsp;PID&nbsp;by&nbsp;properties<br/>
						</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;pid&nbsp;=&nbsp;(String)&nbsp;reference.getProperty(org.osgi.framework.Constants.SERVICE_PID);<br/>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
					</p>
				</div>
			</div>
			</p>
		<a name="_IVaadinApplication" ></a>
		<span style="float:left; border-top: 1px dotted #d4d4dd; margin-left: 0; margin-top: 5px;
			padding: 5px 0;
			padding-top: 5px;"></span><a style="float: right" href="#">Top</a>
			<br style="clear:both"></br>
			<h1>Vaadin-Appplication-service</h1>
			<div class="toc">
			  <ul>
			    <li><a href="05-Vaadin-Application.php#_UIProvider.php" >UI-Provider</a></li>
			  </ul>
			</div>
			<p>
			The <abbr title="org.lunifera.runtime.web.vaadin.osgi.common.IVaadinApplication" >Vaadin-Application-Service</abbr> can be used to get information about the application,
			to control its lifecycle and to added UI-Providers. It is not possible to change the values of its properties. Therefore OSGi-CM must be used.
			</p>
			<a name="_UIProvider" ></a>
			<h2>UI-Provider</h2>
			<p>
			As described above the service allows to add UI-Providers. For normal UI-Providers are provided by the
			core implementation of the Vaadin-Application. They are used to create instances of <span class="inlinecode">com.vaadin.ui.UI</span>
			which are the root UI-elements of each browser tab. In vaadin 7 each browser window or tab is based on
			an UI-instance.
			</p>
			<p>
			The most common way providing an UI-class for a vaadin application is the use of <a href="http://wiki.osgi.org/wiki/Declarative_Services" >OSGi-DS</a> component factories.
			ComponentFactories are able to create many instances of the same service and gain control over their
			lifecycle.
			To prepare a component definition for a Vaadin-Application-UI a UI-implementation has to be created first.
			</p>
			<p>
			It is a good idea to follow the example in <span class="inlinecode">org.lunifera.examples.runtime.web.vaadin.standalone</span>.
			<div class="literallayout">
				<div class="incode">
					<p class="code">
						<span class="keyword">package</span>&nbsp;org.lunifera.examples.runtime.web.vaadin.standalone;<br/>
						<br/>
						@Theme(Reindeer.THEME_NAME)<br/>
						<span class="keyword">public</span>&nbsp;<span class="keyword">class</span>&nbsp;Vaadin7StandaloneDemoUI&nbsp;<span class="keyword">extends</span>&nbsp;OSGiUI&nbsp;{<br/>
						@Override<br/>
						&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span>&nbsp;<span class="keyword">void</span>&nbsp;init(VaadinRequest&nbsp;request)&nbsp;{<br/>
						&nbsp;&nbsp;&nbsp;&nbsp;....
					</p>
				</div>
			</div>
			</p>
			<p>
			As a second step, the OSGi-DS component factory has to be defined and registered at MANIFEST.MF.
			</p>
			<p>
			<div class="literallayout">
				<div class="incode">
					<p class="code">
						&lt;?xml&nbsp;version=<span class="string">"1.0"</span>&nbsp;encoding=<span class="string">"UTF-8"</span>?&gt;<br/>
						&lt;scr:component&nbsp;xmlns:scr=<span class="string">"http://www.osgi.org/xmlns/scr/v1.1.0"</span>&nbsp;<br/>
						&nbsp;&nbsp;&nbsp;&nbsp;factory=<span class="string">"org.lunifera.web.vaadin.UI/org.lunifera.examples.runtime.web.vaadin.standalone.Vaadin7StandaloneDemoUI@VaadinDemo-VaadinApplication"</span>&nbsp;<br/>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;immediate=<span class="string">"false"</span>&nbsp;name=<span class="string">"org.lunifera.examples.runtime.web.vaadin.standalone.ui"</span>&gt;<br/>
						&nbsp;&lt;implementation&nbsp;class=<span class="string">"org.lunifera.examples.runtime.web.vaadin.standalone.Vaadin7StandaloneDemoUI"</span>/&gt;<br/>
						&lt;/scr:component&gt;
					</p>
				</div>
			</div>
			</p>
			<p>
			The most important setting of the xml-definition is the factory property. It follows a strict pattern.
			</p>
			<p>
			<span class="inlinecode">org.lunifera.web.vaadin.UI/org.lunifera.examples.runtime.web.vaadin.standalone.Vaadin7StandaloneDemoUI@VaadinDemo-VaadinApplication</span>
			</p>
			<p>
			<span class="inlinecode">org.lunifera.web.vaadin.UI</span>:
			Common factory name. Has to be called that way since it is used by core to filter all UI-Provider-Factories.
			</p>
			<p>
			<span class="inlinecode">/org.lunifera.examples.runtime.web.vaadin.standalone.Vaadin7StandaloneDemoUI</span>:
			The full qualified name of the UI-Class. Same as specified in property &quot;implementation class&quot;.
			</p>
			<p>
			<span class="inlinecode">@VaadinDemo-VaadinApplication</span>:
			The name of the vaadin application that UI-Provider belongs to. If that fragment does not exist, the
			UI belongs to all Vaadin-Applications.
			</p>
			<p>
			A possible Carstore-Web definition could look something like:
			<div class="literallayout">
				<div class="incode">
					<p class="code">
						&lt;?xml&nbsp;version=<span class="string">"1.0"</span>&nbsp;encoding=<span class="string">"UTF-8"</span>?&gt;<br/>
						&lt;scr:component&nbsp;xmlns:scr=<span class="string">"http://www.osgi.org/xmlns/scr/v1.1.0"</span>&nbsp;<br/>
						&nbsp;&nbsp;&nbsp;&nbsp;factory=<span class="string">"org.lunifera.web.vaadin.UI/org.lunifera.example.carstore.ui.UI@Carstore-Web"</span>&nbsp;<br/>
						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;immediate=<span class="string">"false"</span>&nbsp;name=<span class="string">"org.lunifera.example.carstore.ui"</span>&gt;<br/>
						&nbsp;&lt;implementation&nbsp;class=<span class="string">"org.lunifera.example.carstore.ui.UI"</span>/&gt;<br/>
						&lt;/scr:component&gt;
					</p>
				</div>
			</div>
			
			</p>
		<div id="disqus_thread"></div>
		<script type="text/javascript" src="documentationRoot.js"></script>
		<script type="text/javascript">
		    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
		    var disqus_shortname = 'xtext'; // required: replace example with your forum shortname
		
		    // The following are highly recommended additional parameters. Remove the slashes in front to use.
		    var disqus_identifier = 'VaadinApplication';
		    var disqus_url = documentationRoot+'05-Vaadin-Application.php';
		
		    /* * * DON'T EDIT BELOW THIS LINE * * */
		    (function() {
		        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
		        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
		    })();
		</script>
 		<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	</div>
	<br style="clear:both;height:1em;">
